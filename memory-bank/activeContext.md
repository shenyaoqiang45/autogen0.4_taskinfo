# Active Context: 内容创作 Agent 系统

## 当前工作焦点

### 正在进行
创建基于 AutoGen 0.4+ 的内容创作 agent 系统，实现从主题到完整创作素材的自动化流程。

### 最近完成
- ✅ Memory Bank 核心文档创建
- ✅ 系统架构设计
- ✅ Agent 角色定义
- ✅ 技术栈选型

### 下一步行动
1. 创建项目基础结构（目录、配置文件）
2. 实现核心 Agent 类
3. 集成 MCP 工具（Tavily、高德地图）
4. 实现团队协作逻辑
5. 创建示例和测试代码

## 关键决策

### 1. Agent 协作模式
**决策**: 使用 SelectorGroupChat 而非 RoundRobinGroupChat
**理由**: 
- 更灵活的 agent 选择机制
- 根据任务需要动态选择合适的 agent
- 避免不必要的轮询开销

### 2. 工具集成策略
**决策**: 通过 MCP（Model Context Protocol）集成外部工具
**理由**:
- AutoGen 0.4 原生支持 MCP
- 标准化的工具接口
- 易于扩展和维护

### 3. 数据结构设计
**决策**: 使用 Pydantic 模型定义数据结构
**理由**:
- 类型安全
- 自动验证
- 清晰的数据契约

### 4. 异步执行
**决策**: 全面采用异步模式
**理由**:
- AutoGen 0.4 推荐异步 API
- 更好的性能和资源利用
- 支持并发操作

## 重要模式和偏好

### Agent 提示工程
- 使用清晰的角色定义
- 明确输入输出格式
- 提供具体的工作流程指引
- 包含示例和边界条件

### 错误处理
- 所有外部 API 调用都需要错误处理
- 使用重试机制处理临时性故障
- 提供降级方案（如搜索失败时的处理）
- 记录详细的错误日志

### 代码组织
- Agent 定义独立文件
- 提示模板单独管理
- 工具集成模块化
- 配置与代码分离

## 项目洞察

### 1. AutoGen 0.4 变化
AutoGen 0.4 相比早期版本有重大变化：
- 新的包结构：autogen_agentchat, autogen_ext
- 更强的类型系统
- 原生异步支持
- 改进的团队协作 API

### 2. MCP 工具潜力
MCP（Model Context Protocol）为工具集成提供了标准化方式：
- 统一的工具接口
- 容易添加新工具
- Cline 已经支持多个 MCP 服务器（Tavily、高德地图等）

### 3. 多 Agent 协作挑战
- 消息传递的复杂性
- 状态管理和同步
- 终止条件的设计
- 性能优化（减少不必要的 LLM 调用）

### 4. 实用性考虑
- 引用来源的可靠性验证很重要
- 地理信息需要考虑精度和相关性
- 人物信息要注重隐私保护
- 输出格式要便于创作者使用

## 技术债务和改进点

### 未来优化
- [ ] 添加结果缓存机制
- [ ] 支持流式输出
- [ ] 实现增量式信息补充
- [ ] 添加用户反馈循环
- [ ] 支持多语言

### 已知限制
- 依赖外部 API（网络、配额限制）
- LLM 输出的不确定性
- 处理时间较长（30-60秒）
- 成本考虑（API 调用费用）
